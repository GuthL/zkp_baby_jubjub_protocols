// https://github.com/barryWhiteHat/baby_jubjub_ecc
import "./EC_primitives/baby_jubjub_curve_parameters.code" as params
import "./EC_primitives/baby_jubjub_curve_addition.code" as add
import "./EC_primitives/baby_jubjub_curve_multiply.code" as multiply
import "./EC_primitives/baby_jubjub_curve_assert_on_curve.code" as assertOnCurve

def main(private field h255, private field h254, private field h253, private field h252, private field h251, private field h250, private field h249, private field h248, private field h247, private field h246, private field h245, private field h244, private field h243, private field h242, private field h241, private field h240, private field h239, private field h238, private field h237, private field h236, private field h235, private field h234, private field h233, private field h232, private field h231, private field h230, private field h229, private field h228, private field h227, private field h226, private field h225, private field h224, private field h223, private field h222, private field h221, private field h220, private field h219, private field h218, private field h217, private field h216, private field h215, private field h214, private field h213, private field h212, private field h211, private field h210, private field h209, private field h208, private field h207, private field h206, private field h205, private field h204, private field h203, private field h202, private field h201, private field h200, private field h199, private field h198, private field h197, private field h196, private field h195, private field h194, private field h193, private field h192, private field h191, private field h190, private field h189, private field h188, private field h187, private field h186, private field h185, private field h184, private field h183, private field h182, private field h181, private field h180, private field h179, private field h178, private field h177, private field h176, private field h175, private field h174, private field h173, private field h172, private field h171, private field h170, private field h169, private field h168, private field h167, private field h166, private field h165, private field h164, private field h163, private field h162, private field h161, private field h160, private field h159, private field h158, private field h157, private field h156, private field h155, private field h154, private field h153, private field h152, private field h151, private field h150, private field h149, private field h148, private field h147, private field h146, private field h145, private field h144, private field h143, private field h142, private field h141, private field h140, private field h139, private field h138, private field h137, private field h136, private field h135, private field h134, private field h133, private field h132, private field h131, private field h130, private field h129, private field h128, private field h127, private field h126, private field h125, private field h124, private field h123, private field h122, private field h121, private field h120, private field h119, private field h118, private field h117, private field h116, private field h115, private field h114, private field h113, private field h112, private field h111, private field h110, private field h109, private field h108, private field h107, private field h106, private field h105, private field h104, private field h103, private field h102, private field h101, private field h100, private field h99, private field h98, private field h97, private field h96, private field h95, private field h94, private field h93, private field h92, private field h91, private field h90, private field h89, private field h88, private field h87, private field h86, private field h85, private field h84, private field h83, private field h82, private field h81, private field h80, private field h79, private field h78, private field h77, private field h76, private field h75, private field h74, private field h73, private field h72, private field h71, private field h70, private field h69, private field h68, private field h67, private field h66, private field h65, private field h64, private field h63, private field h62, private field h61, private field h60, private field h59, private field h58, private field h57, private field h56, private field h55, private field h54, private field h53, private field h52, private field h51, private field h50, private field h49, private field h48, private field h47, private field h46, private field h45, private field h44, private field h43, private field h42, private field h41, private field h40, private field h39, private field h38, private field h37, private field h36, private field h35, private field h34, private field h33, private field h32, private field h31, private field h30, private field h29, private field h28, private field h27, private field h26, private field h25, private field h24, private field h23, private field h22, private field h21, private field h20, private field h19, private field h18, private field h17, private field h16, private field h15, private field h14, private field h13, private field h12, private field h11, private field h10, private field h9, private field h8, private field h7, private field h6, private field h5, private field h4, private field h3, private field h2, private field h1, private field h0, field u2, field v2) -> (field):
  1 == assertOnCurve(u2, v2)

  ku, kv = multiply(h255, h254, h253, h252, h251, h250, h249, h248, h247, h246, h245, h244, h243, h242, h241, h240, h239, h238, h237, h236, h235, h234, h233, h232, h231, h230, h229, h228, h227, h226, h225, h224, h223, h222, h221, h220, h219, h218, h217, h216, h215, h214, h213, h212, h211, h210, h209, h208, h207, h206, h205, h204, h203, h202, h201, h200, h199, h198, h197, h196, h195, h194, h193, h192, h191, h190, h189, h188, h187, h186, h185, h184, h183, h182, h181, h180, h179, h178, h177, h176, h175, h174, h173, h172, h171, h170, h169, h168, h167, h166, h165, h164, h163, h162, h161, h160, h159, h158, h157, h156, h155, h154, h153, h152, h151, h150, h149, h148, h147, h146, h145, h144, h143, h142, h141, h140, h139, h138, h137, h136, h135, h134, h133, h132, h131, h130, h129, h128, h127, h126, h125, h124, h123, h122, h121, h120, h119, h118, h117, h116, h115, h114, h113, h112, h111, h110, h109, h108, h107, h106, h105, h104, h103, h102, h101, h100, h99, h98, h97, h96, h95, h94, h93, h92, h91, h90, h89, h88, h87, h86, h85, h84, h83, h82, h81, h80, h79, h78, h77, h76, h75, h74, h73, h72, h71, h70, h69, h68, h67, h66, h65, h64, h63, h62, h61, h60, h59, h58, h57, h56, h55, h54, h53, h52, h51, h50, h49, h48, h47, h46, h45, h44, h43, h42, h41, h40, h39, h38, h37, h36, h35, h34, h33, h32, h31, h30, h29, h28, h27, h26, h25, h24, h23, h22, h21, h20, h19, h18, h17, h16, h15, h14, h13, h12, h11, h10, h9, h8, h7, h6, h5, h4, h3, h2, h1, h0)

  u2 == ku
  v2 == kv
  return 1